<div *ngIf="configuration && configForm"
     [class.open]="isOpened"
     class="configuration">

  <div class="configuration__header">
    <h2>Configuration</h2>
    <button class="close" (click)="close()">
      <fa-icon [icon]="closeIcon"></fa-icon>
    </button>
  </div>

  <div class="configuration__content">

    <form [formGroup]="configForm" class="config-form">
      <div class="configuration__box toggles">
        <mat-slide-toggle *ngIf="configuration.require_compatible_blood_group !== undefined"
                          formControlName="require_compatible_blood_group"
                          [checked]="configuration.require_compatible_blood_group">
          Require compatible blood group
        </mat-slide-toggle>

        <mat-slide-toggle *ngIf="configuration.require_better_match_in_compatibility_index !== undefined"
                          formControlName="require_better_match_in_compatibility_index"
                          [checked]="configuration.require_better_match_in_compatibility_index">
          Require new donor having better CI match than original donor
        </mat-slide-toggle>

        <mat-slide-toggle *ngIf="configuration.require_better_match_in_compatibility_index_or_blood_group !== undefined"
                          formControlName="require_better_match_in_compatibility_index_or_blood_group"
                          [checked]="configuration.require_better_match_in_compatibility_index_or_blood_group">
          Require new donor having better CI match than original donor or blood group match
        </mat-slide-toggle>

        <mat-slide-toggle *ngIf="configuration.use_binary_scoring !== undefined"
                          formControlName="use_binary_scoring"
                          [checked]="configuration.use_binary_scoring">
          Use binary scoring
        </mat-slide-toggle>

        <mat-slide-toggle *ngIf="configuration.allow_low_high_res_incompatible !== undefined"
                          formControlName="allow_low_high_res_incompatible"
                          [checked]="configuration.allow_low_high_res_incompatible">
          Use split resolution
        </mat-slide-toggle>
      </div>

      <div class="configuration__box inputs">
        <mat-form-field *ngIf="configuration.blood_group_compatibility_bonus !== undefined">
          <mat-label>Compatible blood group bonus</mat-label>
          <input value="{{ configuration.blood_group_compatibility_bonus }}"
                 formControlName="blood_group_compatibility_bonus"
                 matInput type="number">
        </mat-form-field>

        <mat-form-field *ngIf="configuration.max_number_of_distinct_countries_in_round !== undefined">
          <mat-label>Max countries in round</mat-label>
          <input value="{{ configuration.max_number_of_distinct_countries_in_round }}"
                 formControlName="max_number_of_distinct_countries_in_round"
                 matInput type="number">
        </mat-form-field>

        <mat-form-field *ngIf="configuration.minimum_total_score !== undefined">
          <mat-label>Minimum transplant score</mat-label>
          <input value="{{ configuration.minimum_total_score }}"
                 formControlName="minimum_total_score"
                 matInput type="number">
        </mat-form-field>

        <mat-form-field *ngIf="configuration.maximum_total_score !== undefined">
          <mat-label>Maximum transplant score</mat-label>
          <input value="{{ configuration.maximum_total_score }}"
                 formControlName="maximum_total_score"
                 matInput type="number">
        </mat-form-field>

        <mat-form-field *ngIf="configuration.max_cycle_length !== undefined">
          <mat-label>Max cycle length</mat-label>
          <input value="{{ configuration.max_cycle_length }}"
                 formControlName="max_cycle_length"
                 matInput type="number">
        </mat-form-field>

        <mat-form-field *ngIf="configuration.max_sequence_length !== undefined">
          <mat-label>Max sequence length</mat-label>
          <input value="{{ configuration.max_sequence_length }}"
                 formControlName="max_sequence_length"
                 matInput type="number">
        </mat-form-field>
      </div>
    </form>

    <app-configuration-scores [configuration]="configuration"
                              [patients]="patients"></app-configuration-scores>

    <app-configuration-countries [configuration]="configuration"
                                 [patients]="patients"></app-configuration-countries>

    <app-configuration-patients [configuration]="configuration"
                                [patients]="patients"></app-configuration-patients>

    <app-button (click)="submitAction()">Recalculate</app-button>
  </div>
</div>
